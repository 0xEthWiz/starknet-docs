<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Interacting with L1 contracts :: Starknet documentation</title>
    <link rel="canonical" href="https://docs.starknet.io/documentation/getting_started/l1l2/">
    <link rel="prev" href="../events/">
    <link rel="next" href="../default_entrypoint/">
    <meta name="generator" content="Antora 3.1.1">

  <link id="theme" rel="stylesheet" title="Default" href="../../../_/css/site.css">
  <link rel="stylesheet" title="Dark" href="../../../_/css/dark-site.css">

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129128514-2"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-129128514-2')</script>
    <script>var uiRootPath = '../../../_'</script>
    <script src="../../../_/js/vendor/medium-zoom.js"></script>
    <script type="text/javascript" id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="e4db29b5-cd94-4bcf-87e4-04f4ca564240" data-blockingmode="manual"></script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>

    <script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-js"></script>

    <script
        src="https://cdn.jsdelivr.net/npm/algoliasearch@4.14.3/dist/algoliasearch-lite.umd.js"
        integrity="sha256-dyJcbGuYfdzNfifkHxYVd/rzeR6SLLcDFYEidcybldM="
        crossorigin="anonymous"
    ></script>

    <script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-recent-searches"></script>

    <script src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-query-suggestions"></script><link rel="icon" href="../../../_/img/favicon/favicon.ico" type="image/x-icon">

<!-- For all browsers -->
<link rel="icon" type="image/png" sizes="32x32" href="../../../_/img/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../_/img/favicon-16x16.png">

<!-- For Google and Chrome -->
<link rel="icon" type="image/png" sizes="192x192" href="../../../_/img/favicon/android-chrome-192x192.png">

<!-- For iPad -->
<link rel="apple-touch-icon" type="image/png" sizes="167x167" href="../../../_/img/favicon/apple-touch-icon.png">
<!-- For iPhone -->
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../../_/img/favicon/apple-touch-icon.png">  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="top-logo">
        <a href="../../.." class="starknet-logo"></a>
        <div class="vertical-divider desktop-only"></div>
        <a href="../../.." class="docs-logo desktop-only">Docs</a>
      </div>
      <!--<a class="navbar-item" href="https://docs.starknet.io">Starknet documentation</a>-->
      <div id="autocomplete" class="autocomplete-root"></div>
      <div class="header-right">
        <div class="theme-toggle-container mobile-only">
          <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle"></button>
        </div>
        <button class="navbar-burger" data-target="topbar-nav">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
    
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item">
          <a class="navbar-link" href="https://starknet.io/" target="_blank">Starknet Home</a>
        </div>
        <div class="navbar-item">
          <a class="navbar-link" href="https://starknet.io/building-on-starknet/tutorials/" target="_blank">Tutorials</a>
        </div>
        <div class="theme-toggle-container">
          <button onclick="switch_style('toggle')" id="theme-toggle" class="theme-toggle navbar-item"></button>
        </div>
      </div>
    </div>
  </nav>
</header><div class="toolbar" role="navigation">
  <div class="components-versions desktop-only">
  </div>
  <span></span>
  <span></span>
  <a href="../../" class="home-link"></a>
  <div id="mobile-autocomplete" class="mobile-only"></div>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../">Starknet</a></li>
    <li><a href="../">Getting started</a></li>
    <li><a href="./">Interacting with L1 contracts</a></li>
  </ul>
</nav>
</div>
<div class="body">
<div class="nav-container" data-component="documentation" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../">Starknet</a></h3>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a 
       class="nav-link"
     href="../../">Introduction</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Starknet versions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../../starknet_versions/version_notes/">Starknet version notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../../starknet_versions/upcoming_versions/">Upcoming Starknet versions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../../starknet_versions/pathfinder_versions/">Pathfinder version notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../../starknet_versions/limits_and_triggers/">Current limits and triggers</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Architecture and concepts</span>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Blocks and transactions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Blocks/header/">Block structure</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Blocks/transaction-life-cycle/">Transaction lifecycle</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Blocks/transactions/">Transaction structure</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Contracts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Contracts/contract-abi/">Contract ABI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Contracts/contract-address/">Contract address</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Contracts/contract-classes/">Contract classes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Contracts/contract-hash/">Contract hash</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Contracts/contract-storage/">Contract storage</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Contracts/system-calls/">System calls</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Account abstraction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Account_Abstraction/introduction/">Introduction to account abstraction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Account_Abstraction/approach/">Starknet account structure</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Account_Abstraction/validate_and_execute/">Validate and execute</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Account_Abstraction/simplified_transaction_flow/">Simplified transaction flow</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Data availability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Data_Availability/on-chain-data/">On-chain data</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Hashing</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Hashing/hash-functions/">Hash functions</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Events</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Events/starknet-events/">Starknet events</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Fees</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/Fees/fee-mechanism/">Fee mechanism</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">L1-L2 Communication</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/L1-L2_Communication/messaging-mechanism/">Messaging mechanism</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/L1-L2_Communication/token-bridge/">StarkGate – Token Bridge</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">State</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../../architecture_and_concepts/State/starknet-state/">Starknet state</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../">Getting started</a>
        </span>
<ul class="nav-list">
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../account_setup/">Setting up a Starknet account</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../account_setup/#installation">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../account_setup/#setting-up-the-network">Setting up the network</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../account_setup/#choosing-a-wallet-provider">Choosing a wallet provider</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../account_setup/#creating-an-account">Creating an account</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../account_setup/#transferring-goerli-eth-to-the-account">Transferring Goerli ETH to the account</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../account_setup/#deploying-an-account">Deploying an account</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../intro/">Writing Starknet contracts</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../intro/#your-first-contract">Your first contract</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../intro/#compile-the-contract">Compile the contract</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../intro/#the-contract-s-abi">The contract’s ABI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../intro/#declare-the-contract-on-the-starknet-testnet">Declare the contract on the Starknet testnet</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../intro/#deploy-the-contract-on-the-starknet-testnet">Deploy the contract on the Starknet testnet</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../intro/#interact-with-the-contract">Interact with the contract</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../intro/#query-the-balance">Query the balance</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../cli/">More CLI commands</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-transaction">get_transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-transaction-receipt">get_transaction_receipt</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-transaction-trace">get_transaction_trace</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#estimate-fee">Estimate fee</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#simulate-transaction">Simulate transaction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-code">get_code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-class-by-hash">get_class_by_hash</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-full-contract">get_full_contract</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-class-hash-at">get_class_hash_at</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-block">get_block</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-nonce">get_nonce</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-block-traces">get_block_traces</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-state-update">get_state_update</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../cli/#get-storage-at">get_storage_at</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../user_auth/">Adding user authentication</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../user_auth/#storage-maps">Storage maps</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../user_auth/#getting-the-caller-address">Getting the caller address</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../user_auth/#modifying-the-contract-s-functions">Modifying the contract’s functions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../user_auth/#compile-and-deploy">Compile and deploy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../user_auth/#interacting-with-the-contract">Interacting with the contract</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../user_auth/#retrieving-the-revert-reason">Retrieving the revert reason</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../constructors/">Constructors</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../more_features/">More features</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../more_features/#storage-variable-with-multiple-values">Storage variable with multiple values</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../more_features/#storage-variable-with-struct-arguments">Storage variable with struct arguments</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../more_features/#array-arguments-in-calldata">Array arguments in calldata</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../more_features/#passing-tuples-and-structs-in-calldata">Passing tuples and structs in calldata</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../more_features/#passing-arrays-of-structs">Passing arrays of structs</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../more_features/#retrieving-the-transaction-information">Retrieving the transaction information</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../more_features/#block-number-and-timestamp">Block number and timestamp</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../calling_contracts/">Calling another contract</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../calling_contracts/#getting-the-current-contract-s-address">Getting the current contract’s address</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../calling_contracts/#library-calls">Library calls</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../deploying_from_contracts/">Deploying a contract by another contract</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../deploying_from_contracts/#the-deploy-system-call">The deploy system call</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../deploying_from_contracts/#using-the-contract">Using the contract</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../events/">Events</a>
  </li>
  <li class="nav-item is-current-page parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="./">Interacting with L1 contracts</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="#background">Background</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="#an-example-of-a-simple-token-bridge">An example of a simple token bridge</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../default_entrypoint/">Default entry point</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../unit_tests/">Writing unit tests</a>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../signature_verification/">Signature verification</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../signature_verification/#compile-and-deploy">Compile and deploy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../signature_verification/#interacting-with-the-contract">Interacting with the contract</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="2">
    <button class="nav-item-toggle"></button>
        <span>
    <a 
       class="nav-link nav-link-with-toggle"
     href="../amm/">A simple Automated Market Maker (AMM)</a>
        </span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../amm/#amm-implementation-in-starknet-alpha">AMM implementation in Starknet Alpha</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../amm/#the-amm-state">The AMM state</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../amm/#swapping-tokens">Swapping tokens</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../amm/#initializing-the-amm">Initializing the AMM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a 
       class="nav-link"
     href="../amm/#interaction-examples">Interaction examples</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item parent" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tools</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../../tools/ref_block_explorers/">Starknet block explorers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../../tools/CLI/commands/">Starknet CLI reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a 
       class="nav-link"
     href="../../tools/CLI/starknet-compiler-options/">Starknet compiler reference</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a 
       class="nav-link"
     href="../../useful_info/">Useful info</a>
  </li>
</ul>
  </li>
  <li class="nav-item parent" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a 
       class="nav-link"
     href="../../end_of_life_and_deprecated_features/">Deprecated and obsolete features</a>
  </li>
</ul>
  </li>
</ul>
    <div class="navbar-end mobile-only">
      <div class="hr-divider"></div>
      <div class="navbar-item-flex">
        <a class="navbar-link" href="https://starknet.io/" target="_blank">Starknet Home</a>
        <a class="link-icon" href="https://starknet.io/" target="_blank"></a>
      </div>
      <div class="navbar-item-flex">
        <a class="navbar-link" href="https://starknet.io/building-on-starknet/tutorials/" target="_blank">Tutorials</a>
        <a class="link-icon" href="https://starknet.io/building-on-starknet/tutorials/" target="_blank"></a>
      </div>
    </div>
  </nav>
</div>
    </div>
  </aside>
</div>
<main class="article">
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Interacting with L1 contracts</h1>
<div class="sect1">
<h2 id="background"><a class="anchor" href="#background"></a>Background</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One important property of a good L2 system is the ability to interact with the L1 system it’s built
on (since otherwise the system is, in fact, isolated). In this section we describe how Starknet
contracts can interact with Ethereum L1 contracts.</p>
</div>
<div class="paragraph">
<p>Every Starknet contract may send and receive messages to/from any L1 contract. Usually, it’s
recommended to design a pair of contracts: an L2 contract and its L1 contract counterpart (for
example, written in Solidity) and decide on the message protocol between the two contracts.</p>
</div>
<div class="sect2">
<h3 id="messages-from-l2-to-l1"><a class="anchor" href="#messages-from-l2-to-l1"></a>Messages from L2 to L1</h3>
<div class="paragraph">
<p>Messages from L2 to L1 work as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Starknet (L2) contract function calls the library function <code>send_message_to_l1()</code> in order to
send the message. It specifies:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The destination L1 contract (<em>to</em>).</p>
</li>
<li>
<p>The data to send (<em>payload</em>).</p>
<div class="paragraph">
<p>The Starknet OS adds the <em>from</em> address, which is the L2 address of the contract sending the message.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Once a state update containing the L2 transaction is accepted on-chain, the message is stored on
the L1 Starknet core contract, waiting to be consumed.</p>
</li>
<li>
<p>The L1 contract specified by the <em>to</em> address invokes the <code>consumeMessageFromL2()</code> of the Starknet
core contract.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Note</strong>: Since any L2 contract can send messages to any L1 contract it is recommended that the L1
contract check the <em>from</em> address before processing the transaction.</p>
</div>
<div class="paragraph">
<p>Below we will show how one can use this mechanism to implement a withdrawal transaction.</p>
</div>
</div>
<div class="sect2">
<h3 id="messages-from-l1-to-l2"><a class="anchor" href="#messages-from-l1-to-l2"></a>Messages from L1 to L2</h3>
<div class="paragraph">
<p>The other direction is similar:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The L1 contract calls (on L1) the <code>send_message()</code> function of the Starknet core contract with a
message and a fee. The core contract stores the message and the fee. In this case the message
includes an additional field - the <em>selector</em>, which determines what function to call in the
corresponding L2 contract.</p>
</li>
<li>
<p>Assuming the fee is sufficient, the Starknet Sequencer automatically consumes the message and
invokes the requested L2 function of the contract designated by the “to” address.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This direction is useful, for example, for <em>deposit</em> transactions.</p>
</div>
<div class="paragraph">
<p>Note that while honest Sequencers automatically consume L1 &#8594; L2 messages, it is not enforced by the
protocol (so a Sequencer may choose to skip a message). This should be taken into account when
designing the message protocol between the two contracts.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Starknet Alpha system is still under development, and therefore from time to time the state of
the system will reset and all contracts will be removed. This means that you shouldn’t move valuable
assets to the Starknet system, unless you have a way to withdraw them given the removal of the L2
contract.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="an-example-of-a-simple-token-bridge"><a class="anchor" href="#an-example-of-a-simple-token-bridge"></a>An example of a simple token bridge</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section we’ll build a simple token bridge – the user will be able to deposit L1 tokens and
their L2 balance will increase. Then, they will be able to withdraw some tokens, which will
decrease their L2 balance and increase their L1 balance in return.</p>
</div>
<div class="sect2">
<h3 id="some-preparations"><a class="anchor" href="#some-preparations"></a>Some preparations</h3>
<div class="paragraph">
<p>Start with the <code>%lang</code> directive, a few imports and a few constants:</p>
</div>
<div id="l1l2_header" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cairo hljs" data-lang="cairo">%lang starknet

from starkware.cairo.common.alloc import alloc
from starkware.cairo.common.cairo_builtins import HashBuiltin
from starkware.cairo.common.math import assert_nn
from starkware.starknet.common.messages import send_message_to_l1

const L1_CONTRACT_ADDRESS = (
    0x8359E4B0152ed5A731162D3c7B0D8D56edB165A0);
const MESSAGE_WITHDRAW = 0;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in real applications you may want to maintain the address of the L1 contract as a storage
variable, rather than a constant.</p>
</div>
<div class="paragraph">
<p>Then, define the storage variable that holds the balances, together with a getter <code>@view</code> function:</p>
</div>
<div id="l1l2_balance" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cairo hljs" data-lang="cairo">// A mapping from a user (L1 Ethereum address) to their balance.
@storage_var
func balance(user: felt) -&gt; (res: felt) {
}

@view
func get_balance{
    syscall_ptr: felt*,
    pedersen_ptr: HashBuiltin*,
    range_check_ptr,
}(user: felt) -&gt; (balance: felt) {
    let (res) = balance.read(user=user);
    return (balance=res);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Just so we’ll have some “funds” to play with, define a function that can mint new tokens (in real
applications you probably wouldn’t want a function that lets the user effectively “print” money.
In addition, you’ll want to check that <code>amount</code> is nonnegative):</p>
</div>
<div id="l1l2_increase_balance" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cairo hljs" data-lang="cairo">@external
func increase_balance{
    syscall_ptr: felt*,
    pedersen_ptr: HashBuiltin*,
    range_check_ptr,
}(user: felt, amount: felt) {
    let (res) = balance.read(user=user);
    balance.write(user, res + amount);
    return ();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sending-a-message-to-l1"><a class="anchor" href="#sending-a-message-to-l1"></a>Sending a message to L1</h3>
<div class="paragraph">
<p>Sending a message to L1 can be useful for withdrawals: The user requesting the withdrawal invokes
a <code>withdraw</code> (L2) transaction. The transaction decreases their L2 balance and sends a message to
the L1 contract, indicating that the user’s L1 balance should be increased by the withdrawn amount.
The L1 counterpart should allow the user to consume the message and increase their balance on L1
when doing so.</p>
</div>
<div id="l1l2_withdraw" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cairo hljs" data-lang="cairo">@external
func withdraw{
    syscall_ptr: felt*,
    pedersen_ptr: HashBuiltin*,
    range_check_ptr,
}(user: felt, amount: felt) {
    // Make sure 'amount' is positive.
    assert_nn(amount);

    let (res) = balance.read(user=user);
    tempvar new_balance = res - amount;

    // Make sure the new balance will be positive.
    assert_nn(new_balance);

    // Update the new balance.
    balance.write(user, new_balance);

    // Send the withdrawal message.
    let (message_payload: felt*) = alloc();
    assert message_payload[0] = MESSAGE_WITHDRAW;
    assert message_payload[1] = user;
    assert message_payload[2] = amount;
    send_message_to_l1(
        to_address=L1_CONTRACT_ADDRESS,
        payload_size=3,
        payload=message_payload,
    );

    return ();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that a new implicit argument was added – the system call pointer (<code>syscall_ptr</code>). This argument
allows us to invoke some functions of the Starknet OS, including the “send message” function.</p>
</div>
<div class="paragraph">
<p>Sending a message is done at the end of <code>withdraw()</code> by calling <code>send_message_to_l1()</code>, which gets
the L1 contract address, the size of the message and the message itself (as a <code>felt*</code>). Note that the
message itself is given as a pointer, and therefore the message length must be passed explicitly. In
our example, the message data is: <code>MESSAGE_WITHDRAW, user, amount</code>. We choose to use the first
element as an indicator of the message type (note that we don’t really need it here since we only
have one message type).</p>
</div>
<div class="paragraph">
<p>Now let’s take a look at how the <a href="../_static/L1L2Example.sol">L1 contract counterpart</a> may be
written. Consider the <code>withdraw()</code> function: It gets the user and the amount, consumes the message
(this part will fail if the message wasn’t received on-chain) and updates the user’s balance
accordingly. As you’ll see below, we passed the address of the L2 contract as an argument to the
function, so that the contract can be deployed once and used by anyone doing this tutorial. However,
normally it doesn’t make sense to get the address of the L2 contract as an argument – the address
should be fixed for each instance of the contract.</p>
</div>
</div>
<div class="sect2">
<h3 id="receiving-a-message-from-l1"><a class="anchor" href="#receiving-a-message-from-l1"></a>Receiving a message from L1</h3>
<div class="paragraph">
<p>In order to handle a message that was sent from an L1 contract, you should declare an L1 handler:</p>
</div>
<div id="l1l2_deposit" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cairo hljs" data-lang="cairo">@l1_handler
func deposit{
    syscall_ptr: felt*,
    pedersen_ptr: HashBuiltin*,
    range_check_ptr,
}(from_address: felt, user: felt, amount: felt) {
    // Make sure the message was sent by the intended L1 contract.
    assert from_address = L1_CONTRACT_ADDRESS;

    // Read the current balance.
    let (res) = balance.read(user=user);

    // Compute and update the new balance.
    tempvar new_balance = res + amount;
    balance.write(user, new_balance);

    return ();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An L1 handler is called by the Starknet OS in order to process a message sent from an L1 contract.
A Starknet contract may define a few L1 handlers, and they are identified by an integer value called
the <em>selector</em>. You can compute the selector based on the L1 handler name using the following Python
code:</p>
</div>
<div id="l1l2_selector" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">from starkware.starknet.compiler.compile import \
    get_selector_from_name

print(get_selector_from_name('deposit'))</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should get:</p>
</div>
<div id="l1l2_selector_output" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-python hljs" data-lang="python">352040181584456735608515580760888541466059565068553383579463728554843487745</code></pre>
</div>
</div>
<div class="paragraph">
<p>When an L1 contract wants to send a message, it calls the <code>sendMessageToL2()</code> function of the
Starknet Core contract specifying the L2 contract address, the selector for the handler to be invoked
and the message payload. The message fee is paid in ETH and needs to be sent with the call.
See the deposit function in the <a href="../_static/L1L2Example.sol">example L1 contract</a> for an example.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-the-contract"><a class="anchor" href="#using-the-contract"></a>Using the contract</h3>
<div class="paragraph">
<p>Save the new Starknet contract file as <code>l1l2.cairo</code>. You can find the full Cairo file
<a href="../_static/l1l2.cairo">here</a>.</p>
</div>
<div class="paragraph">
<p>Compile and declare the contract:</p>
</div>
<div id="l1l2_compile_and_declare" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">starknet-compile l1l2.cairo \
    --output l1l2_compiled.json \
    --abi l1l2_abi.json
starknet declare --contract l1l2_compiled.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>Deploy the contract:</p>
</div>
<div id="l1l2_deploy" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">starknet deploy --class_hash ${L1L2_CLASS_HASH}</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>${L1L2_CLASS_HASH}</code> is the value of class_hash. Don’t forget to set the <code>STARKNET_NETWORK</code>
environment variable to <code>alpha-goerli</code> before running <code>starknet deploy</code>.</p>
</div>
<div class="paragraph">
<p>Set the following environment variable:</p>
</div>
<div id="l1l2_contract_address" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># The deployment address of the previous contract.
export CONTRACT_ADDRESS="&lt;address of the previous contract&gt;"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Choose your favorite <code>USERID</code>, it should be a 251-bit integer value:</p>
</div>
<div id="l1l2_user_id" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export USERID="&lt;favorite 251-bit integer&gt;"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Invoke the <code>increase_balance</code> function:</p>
</div>
<div id="l1l2_invoke_increase_balance" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">starknet invoke \
    --address ${CONTRACT_ADDRESS} \
    --abi l1l2_abi.json \
    --function increase_balance \
    --inputs \
        ${USERID} \
        3333</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the balance is increased, invoke the <code>withdraw</code> function:</p>
</div>
<div id="l1l2_invoke_withdraw" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">starknet invoke \
    --address ${CONTRACT_ADDRESS} \
    --abi l1l2_abi.json \
    --function withdraw \
    --inputs \
        ${USERID} \
        1000</code></pre>
</div>
</div>
<div class="paragraph">
<p>Call <code>get_balance</code> to check that the balance was computed correctly (remember that you’ll have to
wait until the second transaction is included in a block):</p>
</div>
<div id="l1l2_get_balance" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">starknet call \
    --address ${CONTRACT_ADDRESS} \
    --abi l1l2_abi.json \
    --function get_balance \
    --inputs \
        ${USERID}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should get:</p>
</div>
<div id="l1l2_get_balance_output" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">2333</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wait for the transaction to be accepted on-chain (this may take some time) – you can use
<code>starknet tx_status</code> to track the transaction’s progress. Then, invoke the <code>withdraw()</code>
function of the example contract, deployed at address
<a href="https://goerli.etherscan.io/address/0x8359E4B0152ed5A731162D3c7B0D8D56edB165A0#writeContract">0x8359E4B0152ed5A731162D3c7B0D8D56edB165A0</a>,
with the following arguments: <code>CONTRACT_ADDRESS, USERID, 1000</code> (where, as before,
<code>CONTRACT_ADDRESS</code> is the address of the <strong>L2</strong> contract you deployed). After the <code>withdraw()</code>
transaction, the user’s L1 balance should be <code>1000</code> and their L2 balance should be <code>2333</code>.</p>
</div>
<div class="paragraph">
<p>After your <code>withdraw()</code> transaction is accepted on-chain, you can deposit some of the withdrawn funds
back to L2. Call the <code>deposit()</code> function of the example contract with the following arguments:
<code>CONTRACT_ADDRESS, USERID, 600</code> and pay the message fee in ETH. For the Goerli testnet, you can use a
message fee of <code>0.01</code> ETH. (Note that the ‘value’ to pay in ETH is displayed as <code>payableAmount</code> in
Etherscan.) It may take some time until Starknet processes the incoming message and calls the L1
handler (for example, the system waits for a few blockchain confirmations). But after that time,
you’ll be able to see the updated balance of the user by invoking <code>starknet call</code> for <code>get_balance</code>
again. The new balances should be: L1 balance – <code>400</code> and L2 balance – <code>2933</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="estimate-message-fee"><a class="anchor" href="#estimate-message-fee"></a>Estimate message fee</h3>
<div class="paragraph">
<p>You can estimate the L2 costs of a given message from L1 before sending it. The <code>estimate_message_fee</code>
command estimates the L2 costs of handling a message from L1 without affecting the contract state.
This is similar to using the <a href="../cli/#estimate-fee" class="xref page">estimate_fee</a> flag for an invoke function.
The result is presented in WEI and ETH, as shown below.</p>
</div>
<div class="paragraph">
<p>First, set the sender address (an L1 address) of the message you wish to simulate. In our case, use
the address of the example contract from the last section.</p>
</div>
<div id="l1l2_l1_contract_address" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export L1_CONTRACT_ADDRESS=0x8359E4B0152ed5A731162D3c7B0D8D56edB165A0</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, to estimate the fee of a given message (in this example – invoking <code>deposit()</code>)
run the following:</p>
</div>
<div id="l1l2_estimate_message_fee" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">starknet estimate_message_fee \
    --from_address ${L1_CONTRACT_ADDRESS} \
    --address ${CONTRACT_ADDRESS} \
    --abi l1l2_abi.json \
    --function deposit \
    --inputs \
        ${USERID} \
        200</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output should resemble:</p>
</div>
<div id="l1l2_estimate_message_fee_output" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">The estimated fee is: 2081700000000000 WEI (0.002082 ETH).
Gas usage: 20817
Gas price: 100000000000 WEI</code></pre>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../events/">Events</a></span>
  <span class="next"><a href="../default_entrypoint/">Default entry point</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footerdiv">
    <div class="footer-left">
      <p>Built with ✨ by the Starknet community</p>
    </div>
    <!-- <div class="community-section">
      <p class="community-section__text">Follow Lisk on: </p>
      <div class="community-section__icons"> -->
    <div class="community_icons">
        <a href="https://twitter.com/@Starknet" title="Twitter" target="_blank" class="footer_icon icon-twitter"><p>Twitter</p></a>
        <a href="https://starknet.io/discord" title="Discord" target="_blank" class="footer_icon icon-discord"><p>Discord</p></a>
        <a href="https://github.com/starkware-libs" title="GitHub" target="_blank" class="footer_icon icon-github"><p>GitHub</p></a>
        <a href="https://www.youtube.com/@starkware_ltd/" title="YouTube" target="_blank" class="footer_icon icon-youtube"><p>YouTube</p></a>
  <!--    </div> -->
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script async src="../../../_/js/vendor/tabs-block-behaviour.js"></script>
<script async src="../../../_/js/vendor/swagger-ui.js"></script>
<script async src="../../../_/js/vendor/component-versions.js"></script>
<script src="../../../_/js/vendor/custom.js"></script>

<script>
    const { algoliasearch } = window;
    const { autocomplete, getAlgoliaResults, getAlgoliaFacets} = window["@algolia/autocomplete-js"]
    const { createLocalStorageRecentSearchesPlugin, search } = window['@algolia/autocomplete-plugin-recent-searches'];
    const { createQuerySuggestionsPlugin } = window['@algolia/autocomplete-plugin-query-suggestions'];

    const appId = "VHYJO45TI4";
    const apiKey = "9d5f273e78238a8c505526e481c857f7";
    const searchClient = algoliasearch(appId, apiKey);

    const querySuggestionsPlugin = createQuerySuggestionsPlugin({
      searchClient,
      indexName: 'web_query_suggestions_dev',
      getSearchParams({ state }) {
        return { hitsPerPage: 3 };
      },
      transformSource({ source, onTapAhead }) {

        const onSelectSuggestion = (event, item) => {
          event.preventDefault();
          event.stopPropagation();
          onTapAhead(item)
        };

        return {
          ...source,
          templates: {
            ...source.templates,
            header({ state, html }) {
              if (state.query) {
                return null;
              }

              return (html`
                <div>
                  <span className="aa-SourceHeaderTitle">Popular searches</span>
                </div>
              `);
            },
            item({html, item}){

              
              return (html`
                <div class="aa-ItemWrapper" onclick=${event => onSelectSuggestion(event, item)}>
                  <div class="aa-ItemContent">
                    <div class="aa-ItemIcon aa-ItemIcon--noBorder">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                          <path d="M16.041 15.856c-0.034 0.026-0.067 0.055-0.099 0.087s-0.060 0.064-0.087 0.099c-1.258 1.213-2.969 1.958-4.855 1.958-1.933 0-3.682-0.782-4.95-2.050s-2.050-3.017-2.050-4.95 0.782-3.682 2.050-4.95 3.017-2.050 4.95-2.050 3.682 0.782 4.95 2.050 2.050 3.017 2.050 4.95c0 1.886-0.745 3.597-1.959 4.856zM21.707 20.293l-3.675-3.675c1.231-1.54 1.968-3.493 1.968-5.618 0-2.485-1.008-4.736-2.636-6.364s-3.879-2.636-6.364-2.636-4.736 1.008-6.364 2.636-2.636 3.879-2.636 6.364 1.008 4.736 2.636 6.364 3.879 2.636 6.364 2.636c2.125 0 4.078-0.737 5.618-1.968l3.675 3.675c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414z"></path>
                        </svg>
                    </div>
                    <div class="aa-ItemContentBody">
                        <div class="aa-ItemContentTitle">${item.query}</div>
                    </div>
                  </div>
                  <div class="aa-ItemActions">
                    <button class="aa-ItemActionButton" title=${`Fill query with "${item.query}"`}>
                        <svg viewBox="0 0 24 24" fill="currentColor">
                          <path d="M8 17v-7.586l8.293 8.293c0.391 0.391 1.024 0.391 1.414 0s0.391-1.024 0-1.414l-8.293-8.293h7.586c0.552 0 1-0.448 1-1s-0.448-1-1-1h-10c-0.552 0-1 0.448-1 1v10c0 0.552 0.448 1 1 1s1-0.448 1-1z"></path>
                        </svg>
                    </button>
                  </div>
                </div>
              `)
            }
          },
          onSelect({event, item, setIsOpen, itemInputValue, setQuery, refresh, ...rest}) {
            setIsOpen(true);
          },
        };
      },
    });

    function createLocalStorageRecentlyViewedItems(params) {
      const {
        onReset,
        onSubmit,
        subscribe,
        ...plugin
      } = createLocalStorageRecentSearchesPlugin({
        ...params,
        search(params) {
          if (params.query) {
            return [];
          }

          return search(params);
        },
        transformSource({ source, onRemove, state }) {
          const transformedSource = params.transformSource
            ? params.transformSource({ source, onRemove, state })
            : source;

          return {
            ...transformedSource,
            getItemUrl({ item }) {
              return item.url;
            },
            templates: {
              ...transformedSource.templates,
              header({html}) {
                return (html`
                  <div>
                    <span class="aa-SourceHeaderTitle">Recently viewed</span>
                  </div>
                `);
              },
              item({ item, components, html }) {

               const removeRecentItem = (event) => {
                    event.preventDefault();
                    event.stopPropagation();
                    onRemove(item.id);
                }

                return (html`
                  <a class="aa-ItemLink" href=${item.url}>
                    <div class="aa-ItemContent">
                      <div class="aa-ItemIcon aa-ItemIcon--noBorder">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                          <path d="M12.516 6.984v5.25l4.5 2.672-0.75 1.266-5.25-3.188v-6h1.5zM12 20.016q3.281 0 5.648-2.367t2.367-5.648-2.367-5.648-5.648-2.367-5.648 2.367-2.367 5.648 2.367 5.648 5.648 2.367zM12 2.016q4.125 0 7.055 2.93t2.93 7.055-2.93 7.055-7.055 2.93-7.055-2.93-2.93-7.055 2.93-7.055 7.055-2.93z" />
                        </svg>
                      </div>
                      <div class="aa-ItemContentBody">
                        <div class="aa-ItemContentTitle">
                          ${components.Highlight({ attribute: 'title', hit: item })}
                        </div>
                      </div>
                    </div>
                    <div class="aa-ItemActions">
                      <button
                        class="aa-ItemActionButton aa-ItemActionButtonDanger"
                        title="Remove this search"
                        onclick=${event => removeRecentItem(event)}
                      >
                        <svg
                          viewBox="0 0 24 24"
                          width="18"
                          height="18"
                          fill="currentColor"
                        >
                          <path d="M18 7v13c0 0.276-0.111 0.525-0.293 0.707s-0.431 0.293-0.707 0.293h-10c-0.276 0-0.525-0.111-0.707-0.293s-0.293-0.431-0.293-0.707v-13zM17 5v-1c0-0.828-0.337-1.58-0.879-2.121s-1.293-0.879-2.121-0.879h-4c-0.828 0-1.58 0.337-2.121 0.879s-0.879 1.293-0.879 2.121v1h-4c-0.552 0-1 0.448-1 1s0.448 1 1 1h1v13c0 0.828 0.337 1.58 0.879 2.121s1.293 0.879 2.121 0.879h10c0.828 0 1.58-0.337 2.121-0.879s0.879-1.293 0.879-2.121v-13h1c0.552 0 1-0.448 1-1s-0.448-1-1-1zM9 5v-1c0-0.276 0.111-0.525 0.293-0.707s0.431-0.293 0.707-0.293h4c0.276 0 0.525 0.111 0.707 0.293s0.293 0.431 0.293 0.707v1zM9 11v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1zM13 11v6c0 0.552 0.448 1 1 1s1-0.448 1-1v-6c0-0.552-0.448-1-1-1s-1 0.448-1 1z" />
                        </svg>
                      </button>
                    </div>
                  </a>
                `);
              }
            }
          };
        }
      });

      const { getAlgoliaSearchParams, ...data } = plugin.data;

      return {
        ...plugin,
        data
      };
    }

    function getSources({ query, state }) {
        if (!query) {
          return [];
        }

        return [
          {
            sourceId: "docs",
            getItems() {
              return getAlgoliaResults({
                searchClient,
                queries: [
                  {
                    indexName: "starknet-docs-dev",
                    query,
                    params: {
                      attributesToSnippet: ["title:10", "content:10"],
                      snippetEllipsisText: "…",
                    }
                  }
                ]
              });
            },
            onSelect({ item }) {
              recentlyViewedItems.data.addItem({
                id: item.objectID,
                title: item.title || item.content,
                url: item.url
              });
            },
            templates: {
              header({html, items}) {
                if(items.length === 0){
                  return null
                }
                return (
                  html`<span class="aa-SourceHeaderTitle">Documentation</span>`
                );
              },
              item({ item: hit, components, html, ...rest }) {
                return (html`
                    <a href=${hit.url} class="aa-ItemLink">
                      <div class="aa-ItemContent">
                        <div class="aa-ItemIcon aa-ItemIcon--noBorder">
                          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M19.5999 9.99999C19.5999 15.3019 15.3018 19.6 9.9999 19.6C4.69797 19.6 0.399902 15.3019 0.399902 9.99999C0.399902 4.69806 4.69797 0.399994 9.9999 0.399994C15.3018 0.399994 19.5999 4.69806 19.5999 9.99999ZM17.7961 10.2449C17.6667 14.4394 14.2258 17.8 9.9999 17.8C5.69208 17.8 2.1999 14.3078 2.1999 9.99999C2.1999 6.55187 4.43732 3.62632 7.53954 2.59597L6.31196 4.74422C5.92196 5.42673 6.03701 6.28582 6.59284 6.84165C7.12339 7.37219 7.9339 7.50372 8.60499 7.16818L8.81467 7.06334C8.89798 7.02168 8.98985 6.99999 9.083 6.99999H9.25807C9.48534 6.99999 9.69309 7.1284 9.79473 7.33167C9.87919 7.50058 9.87919 7.69941 9.79473 7.86832L9.76138 7.93502C9.68018 8.09741 9.51421 8.19999 9.33265 8.19999H8.73006C7.82327 8.19999 6.97648 8.65319 6.47348 9.40768L6.42091 9.48654C5.98984 10.1331 5.88144 10.9426 6.12719 11.6798C6.37831 12.4331 6.97335 13.0237 7.72395 13.2739C8.00786 13.3685 8.19971 13.635 8.19971 13.9298V15.1895C8.19971 15.9685 8.8312 16.6 9.61018 16.6C10.0387 16.6 10.4439 16.4052 10.7116 16.0706L12.6452 13.6536C12.8747 13.3667 12.9997 13.0103 12.9997 12.643C12.9997 12.2639 13.1533 11.8949 13.4236 11.6246C13.9704 11.0778 14.0636 10.2141 13.6307 9.56485L13.074 8.72974C13.0256 8.65709 12.9997 8.57174 12.9997 8.48444C12.9997 8.12003 13.4157 7.91201 13.7073 8.13066L14.1185 8.4391C14.4975 8.7233 15.0044 8.76847 15.4274 8.55695C15.6984 8.42147 16.0258 8.47464 16.2395 8.68826L17.7961 10.2449Z" fill="currentColor"/>
                          </svg>
                        </div>
                        <div class="aa-ItemContentBody">
                          <div class="hit-title">
                            ${components.Highlight({ attribute: 'title', hit })}
                          </div>
                          <div class="hit-desc">
                            ${components.Highlight({ attribute: 'content', hit })}
                          </div>
                        </div>
                      </div>
                      <div class="aa-ItemActions">
                        <button
                          class="aa-ItemActionButton"
                          title="Visit this link"
                        >
                          <svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" clip-rule="evenodd" d="M9.35103 3.1786C9.69424 3.53815 9.68099 4.10784 9.32144 4.45105L4.34632 9.20003H16.35C19.9122 9.20003 22.8 12.0878 22.8 15.65C22.8 19.2123 19.9122 22.1 16.35 22.1H12.9C12.403 22.1 12 21.6971 12 21.2C12 20.703 12.403 20.3 12.9 20.3H16.35C18.9181 20.3 21 18.2182 21 15.65C21 13.0819 18.9181 11 16.35 11H4.34632L9.32144 15.749C9.68099 16.0922 9.69424 16.6619 9.35103 17.0215C9.00783 17.381 8.43813 17.3943 8.07858 17.051L1.47858 10.751C1.30067 10.5812 1.20001 10.346 1.20001 10.1C1.20001 9.85407 1.30067 9.61883 1.47858 9.44901L8.07858 3.14901C8.43813 2.8058 9.00783 2.81905 9.35103 3.1786Z" fill="currentColor"/>
                          </svg>
                        </button>
                      </div>
                    </a>
                  `)
              },
              noResults({state, html}) {
                return (html`
                  No results for <bold>"${state.query}"</bold> 😕
                `);
              }
            }
          }
        ];
    };

    const recentlyViewedItems = createLocalStorageRecentlyViewedItems({
      key: "RECENTLY_VIEWED",
      limit: 5
    });

    autocomplete({
      container: "#autocomplete",
      placeholder: "Search",
      openOnFocus: true,
      detachedMediaQuery: "",
      getSources,
      plugins: [recentlyViewedItems, querySuggestionsPlugin]
    });

</script>

<script> 
  const modalBreakpoint = 680;
  const modalClassname = 'aa-DetachedContainer--modal'

  function toggleAlgoliaModal(){
      const algoliaDetachedContainer = document.querySelector('.aa-DetachedContainer')
      if(!algoliaDetachedContainer){
        return
      }
      const documentWidth = document.documentElement.clientWidth;
      if(documentWidth >= modalBreakpoint){
        algoliaDetachedContainer.classList.add(modalClassname)
      }else {
        algoliaDetachedContainer.classList.remove(modalClassname)
      }
  }
    
  // Attaching the event listener function to window's resize event
  window.addEventListener("resize", toggleAlgoliaModal);

  // Calling the function for the first time
  toggleAlgoliaModal();

</script>  </body>
</html>
